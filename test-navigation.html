<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ –¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="config.js"></script>
    <script src="standalone.js"></script>
    <script src="ad-manager.js"></script>
    <script src="card-manager.js"></script>
    <link rel="stylesheet" href="styles.css">
    <style>
        .test-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 10000;
            max-width: 300px;
            font-size: 12px;
        }
        .test-button {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            background: rgba(255,255,255,0.3);
        }
        .log {
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 10px;
        }
    </style>
</head>
<body>
    <!-- –¢–µ—Å—Ç–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <div class="test-panel">
        <h3>üîß –¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</h3>
        <button class="test-button" onclick="testShowShop()">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
        <button class="test-button" onclick="testShowReadings()">üîÆ –ì–∞–¥–∞–Ω–∏—è</button>
        <button class="test-button" onclick="testShowCabinet()">üë§ –ö–∞–±–∏–Ω–µ—Ç</button>
        <button class="test-button" onclick="checkElements()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <button class="test-button" onclick="clearLog()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
        <div class="log" id="log"></div>
    </div>

    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–∞–¥–∞–Ω–∏–π -->
    <div class="container" id="mainPage">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ –º–µ–Ω—é -->
        <nav class="navbar">
            <div class="nav-brand">
                <h1>üîÆ –¢–∞—Ä–æ</h1>
            </div>
            <div class="nav-balance">
                <div class="balance-display">
                    <span class="balance-icon">üí∞</span>
                    <span class="balance-amount" id="balanceAmount">1000</span>
                    <span class="balance-currency">–º–æ–Ω–µ—Ç</span>
                </div>
            </div>
        </nav>

        <header class="header">
            <h1>üîÆ –¢–∞—Ä–æ –ú–∏–Ω–∏-–ê–ø–ø</h1>
            <p class="subtitle">–†–∞—Å–∫—Ä–æ–π—Ç–µ —Ç–∞–π–Ω—ã –±—É–¥—É—â–µ–≥–æ</p>
        </header>

        <main class="main">
            <section class="spread-selection" id="spreadSelection">
                <h2>üé¥ –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å–∫–ª–∞–¥</h2>
                <div class="spreads-grid">
                    <div class="spread-card" data-spread="one_card">
                        <h3>–û–¥–Ω–∞ –∫–∞—Ä—Ç–∞</h3>
                        <p>–ü—Ä–æ—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å</p>
                        <span class="price">50 –º–æ–Ω–µ—Ç</span>
                    </div>
                    <div class="spread-card" data-spread="three_cards">
                        <h3>–¢—Ä–∏ –∫–∞—Ä—Ç—ã</h3>
                        <p>–ü—Ä–æ—à–ª–æ–µ, –Ω–∞—Å—Ç–æ—è—â–µ–µ, –±—É–¥—É—â–µ–µ</p>
                        <span class="price">100 –º–æ–Ω–µ—Ç</span>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞ -->
    <div class="container" id="shopPage" style="display: none;">
        <nav class="navbar">
            <div class="nav-brand">
                <h1>üõí –ú–∞–≥–∞–∑–∏–Ω</h1>
            </div>
            <div class="nav-balance">
                <div class="balance-display">
                    <span class="balance-icon">üí∞</span>
                    <span class="balance-amount" id="shopBalanceAmount">1000</span>
                    <span class="balance-currency">–º–æ–Ω–µ—Ç</span>
                </div>
            </div>
        </nav>
        <div class="shop-section">
            <div class="shop-container">
                <h2>üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
                <div class="shop-categories">
                    <div class="shop-category">
                        <h3>üíé –ú–æ–Ω–µ—Ç—ã</h3>
                        <div class="shop-items">
                            <div class="shop-item">
                                <div class="item-icon">üí∞</div>
                                <div class="item-info">
                                    <h4>100 –º–æ–Ω–µ—Ç</h4>
                                    <p>–ë–∞–∑–æ–≤—ã–π –ø–∞–∫–µ—Ç</p>
                                </div>
                                <div class="item-price">$0.99</div>
                                <button class="btn-buy">–ö—É–ø–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞–±–∏–Ω–µ—Ç–∞ -->
    <div class="container" id="cabinetPage" style="display: none;">
        <nav class="navbar">
            <div class="nav-brand">
                <h1>üë§ –ö–∞–±–∏–Ω–µ—Ç</h1>
            </div>
            <div class="nav-balance">
                <div class="balance-display">
                    <span class="balance-icon">üí∞</span>
                    <span class="balance-amount" id="cabinetBalanceAmount">1000</span>
                    <span class="balance-currency">–º–æ–Ω–µ—Ç</span>
                </div>
            </div>
        </nav>
        <div class="cabinet-section">
            <div class="cabinet-container">
                <h2>üë§ –ö–∞–±–∏–Ω–µ—Ç</h2>
                <div class="user-profile">
                    <div class="profile-avatar">
                        <span class="avatar-icon">üë§</span>
                    </div>
                    <div class="profile-info">
                        <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>
                        <p>ID: 123456789</p>
                        <div class="profile-balance">
                            <span class="balance-icon">üí∞</span>
                            <span class="balance-amount" id="profileBalance">1000</span>
                            <span class="balance-currency">–º–æ–Ω–µ—Ç</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é -->
    <nav class="bottom-nav">
        <button class="nav-item" id="navShop">
            <span class="nav-icon">üõí</span>
            <span class="nav-label">–ú–∞–≥–∞–∑–∏–Ω</span>
        </button>
        <button class="nav-item active" id="navReadings">
            <span class="nav-icon">üîÆ</span>
            <span class="nav-label">–ì–∞–¥–∞–Ω–∏—è</span>
        </button>
        <button class="nav-item" id="navCabinet">
            <span class="nav-icon">üë§</span>
            <span class="nav-label">–ö–∞–±–∏–Ω–µ—Ç</span>
        </button>
    </nav>

    <script src="script.js"></script>
    <script src="enhanced-features.js"></script>
    <script src="notifications.js"></script>
    
    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${time}] ${message}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(message);
        }

        // –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function showPage(pageId, activeButtonId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const pages = ['mainPage', 'shopPage', 'cabinetPage'];
            pages.forEach(id => {
                const page = document.getElementById(id);
                if (page) page.style.display = 'none';
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.style.display = 'block';
                log(`‚úÖ –ü–æ–∫–∞–∑–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞: ${pageId}`);
            } else {
                log(`‚ùå –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: ${pageId}`);
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            const activeButton = document.getElementById(activeButtonId);
            if (activeButton) {
                activeButton.classList.add('active');
                log(`‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞: ${activeButtonId}`);
            }
        }

        function testShowShop() {
            log('–¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∫–∞–∑ –º–∞–≥–∞–∑–∏–Ω–∞...');
            if (window.testNavigation && window.testNavigation.showShop) {
                window.testNavigation.showShop();
                log('‚úÖ –§—É–Ω–∫—Ü–∏—è showShop –≤—ã–∑–≤–∞–Ω–∞');
            } else {
                log('‚ùå –§—É–Ω–∫—Ü–∏—è showShop –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é');
                showPage('shopPage', 'navShop');
            }
        }

        function testShowReadings() {
            log('–¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∫–∞–∑ –≥–∞–¥–∞–Ω–∏–π...');
            if (window.testNavigation && window.testNavigation.showReadings) {
                window.testNavigation.showReadings();
                log('‚úÖ –§—É–Ω–∫—Ü–∏—è showReadings –≤—ã–∑–≤–∞–Ω–∞');
            } else {
                log('‚ùå –§—É–Ω–∫—Ü–∏—è showReadings –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é');
                showPage('mainPage', 'navReadings');
            }
        }

        function testShowCabinet() {
            log('–¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∫–∞–∑ –∫–∞–±–∏–Ω–µ—Ç–∞...');
            if (window.testNavigation && window.testNavigation.showCabinet) {
                window.testNavigation.showCabinet();
                log('‚úÖ –§—É–Ω–∫—Ü–∏—è showCabinet –≤—ã–∑–≤–∞–Ω–∞');
            } else {
                log('‚ùå –§—É–Ω–∫—Ü–∏—è showCabinet –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é');
                showPage('cabinetPage', 'navCabinet');
            }
        }

        function checkElements() {
            log('–ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏...');
            
            const navShop = document.getElementById('navShop');
            const navReadings = document.getElementById('navReadings');
            const navCabinet = document.getElementById('navCabinet');
            
            log(`navShop: ${navShop ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω'}`);
            log(`navReadings: ${navReadings ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω'}`);
            log(`navCabinet: ${navCabinet ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω'}`);
            
            const mainPage = document.getElementById('mainPage');
            const shopPage = document.getElementById('shopPage');
            const cabinetPage = document.getElementById('cabinetPage');
            
            log(`mainPage: ${mainPage ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω'}`);
            log(`shopPage: ${shopPage ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω'}`);
            log(`cabinetPage: ${cabinetPage ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω'}`);
            
            const navItems = document.querySelectorAll('.nav-item');
            log(`–ù–∞–π–¥–µ–Ω–æ –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏: ${navItems.length}`);
            
            navItems.forEach((item, index) => {
                log(`–ö–Ω–æ–ø–∫–∞ ${index}: ${item.id} - "${item.textContent.trim()}"`);
            });
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É...');
            setTimeout(() => {
                checkElements();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π
                log('–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π...');
                log(`window.testNavigation: ${window.testNavigation ? '‚úÖ –Ω–∞–π–¥–µ–Ω–∞' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'}`);
                log(`window.forceInitNavigation: ${window.forceInitNavigation ? '‚úÖ –Ω–∞–π–¥–µ–Ω–∞' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'}`);
                log(`window.initBottomNavigation: ${window.initBottomNavigation ? '‚úÖ –Ω–∞–π–¥–µ–Ω–∞' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'}`);
                
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
                if (window.forceInitNavigation) {
                    log('–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é...');
                    window.forceInitNavigation();
                } else if (window.initBottomNavigation) {
                    log('–í—ã–∑—ã–≤–∞–µ–º initBottomNavigation –Ω–∞–ø—Ä—è–º—É—é...');
                    window.initBottomNavigation();
                } else {
                    log('‚ùå –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!');
                }
                
                // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    log('–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π...');
                    log(`window.testNavigation: ${window.testNavigation ? '‚úÖ –Ω–∞–π–¥–µ–Ω–∞' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω–∞'}`);
                    if (window.testNavigation) {
                        log('–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:', Object.keys(window.testNavigation));
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                    log('–î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π...');
                    const navShop = document.getElementById('navShop');
                    const navReadings = document.getElementById('navReadings');
                    const navCabinet = document.getElementById('navCabinet');
                    
                    if (navShop) {
                        navShop.addEventListener('click', (e) => {
                            e.preventDefault();
                            log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ú–∞–≥–∞–∑–∏–Ω');
                            showPage('shopPage', 'navShop');
                        });
                        log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è navShop –¥–æ–±–∞–≤–ª–µ–Ω');
                    }
                    
                    if (navReadings) {
                        navReadings.addEventListener('click', (e) => {
                            e.preventDefault();
                            log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ì–∞–¥–∞–Ω–∏—è');
                            showPage('mainPage', 'navReadings');
                        });
                        log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è navReadings –¥–æ–±–∞–≤–ª–µ–Ω');
                    }
                    
                    if (navCabinet) {
                        navCabinet.addEventListener('click', (e) => {
                            e.preventDefault();
                            log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ö–∞–±–∏–Ω–µ—Ç');
                            showPage('cabinetPage', 'navCabinet');
                        });
                        log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è navCabinet –¥–æ–±–∞–≤–ª–µ–Ω');
                    }
                }, 3000);
            }, 2000);
        });
    </script>
</body>
</html>
